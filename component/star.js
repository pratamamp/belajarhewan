import React, { useRef, useEffect, useState } from "react";
import {View, Text, Animated, TouchableOpacity} from 'react-native'
import Svg, { Path, Defs, LinearGradient, Stop, G } from "react-native-svg";
import Sound from "react-native-sound";

Sound.setCategory('Playback')

export default function StarIcon({style, rotation, width, height, scale}) {
  const scaleAnim = useRef(new Animated.Value(0)).current
  const fadeAnim = useRef(new Animated.Value(0)).current
  
  useEffect(() => {
    Animated.sequence([
      Animated.timing(fadeAnim, {
        toValue: 1,
        duration: 1000,
        useNativeDriver: true
      }),

      Animated.spring(scaleAnim, {
        toValue: scale,
        friction: 3,
        tension: 80,
        useNativeDriver: true
      })
    ]).start()
    let effect = new Sound(require('../assets/sound/effect/star.mp3'), err => {
      if(err) {
        console.log('failed load sound!');
        return;
      }
      effect.play((succ)=> {
        if(succ) {
          effect.stop()
          effect.release()
        }
      })
    })
  }, [])
  
  return (
    <Animated.View
      style={{
        opacity: fadeAnim,
        transform: [{scale: scaleAnim}]
      }}
    > 
      <Svg
        style={{...style}}
        fill="none"
        width={width}
        height={height}
        viewBox="0 0 250 250"
        xmlns="http://www.w3.org/2000/svg"
      >
        <G x="50" y="50" rotation={rotation} originX="60" originY="60">
          <Path
            d="M71.057 9.12l16.5 22.968c1.011 1.35 2.695 2.702 4.379 3.04l26.941 7.43c5.388 1.352 7.745 8.107 4.378 12.498l-16.165 22.63c-1.01 1.351-1.684 3.378-1.684 5.067l1.347 28.034c.337 5.742-5.051 9.795-10.776 8.107l-26.604-8.782c-1.684-.676-3.705-.676-5.388 0l-26.268 10.133c-5.051 2.364-10.776-1.689-10.776-7.431V84.779a8.312 8.312 0 00-1.684-5.066L7.746 57.758C4.04 53.367 6.062 46.612 11.45 44.923l26.604-8.444c1.684-.676 3.368-1.69 4.378-3.378L57.586 9.457c3.368-4.728 10.103-5.066 13.47-.337z"
            fill="#8C3A2B"
          />
          <Path
            d="M71.057 9.12l16.5 22.968c1.011 1.35 2.695 2.702 4.379 3.04l26.941 7.43c5.388 1.352 7.745 8.107 4.378 12.498l-16.165 22.63c-1.01 1.351-1.684 3.378-1.684 5.067l1.347 28.034c.337 5.742-5.051 9.795-10.776 8.107l-26.604-8.782c-1.684-.676-3.705-.676-5.388 0l-26.268 10.133c-5.051 2.364-10.776-1.689-10.776-7.431V84.779a8.312 8.312 0 00-1.684-5.066L7.746 57.758C4.04 53.367 6.062 46.612 11.45 44.923l26.604-8.444c1.684-.676 3.368-1.69 4.378-3.378L57.586 9.457c3.368-4.728 10.103-5.066 13.47-.337z"
            stroke="#8C3A2B"
            strokeWidth={3.433}
            strokeMiterlimit={10}
            strokeLinecap="round"
            strokeLinejoin="round"
          />
          <Path
            d="M71.057 9.12l16.5 22.968c1.011 1.35 2.695 2.702 4.379 3.04l26.941 7.43c5.388 1.352 7.745 8.107 4.378 12.498l-16.165 22.63c-1.01 1.351-1.684 3.378-1.684 5.067l1.347 28.034c.337 5.742-5.051 9.795-10.776 8.107l-26.604-8.782c-1.684-.676-3.705-.676-5.388 0l-26.268 10.133c-5.051 2.364-10.776-1.689-10.776-7.431V84.779a8.312 8.312 0 00-1.684-5.066L7.746 57.758C4.04 53.367 6.062 46.612 11.45 44.923l26.604-8.444c1.684-.676 3.368-1.69 4.378-3.378L57.586 9.457c3.368-4.728 10.103-5.066 13.47-.337z"
            fill="#A83727"
          />
          <Path
            d="M71.057 9.12l16.5 22.968c1.011 1.35 2.695 2.702 4.379 3.04l26.941 7.43c5.388 1.352 7.745 8.107 4.378 12.498l-16.165 22.63c-1.01 1.351-1.684 3.378-1.684 5.067l1.347 28.034c.337 5.742-5.051 9.795-10.776 8.107l-26.604-8.782c-1.684-.676-3.705-.676-5.388 0l-26.268 10.133c-5.051 2.364-10.776-1.689-10.776-7.431V84.779a8.312 8.312 0 00-1.684-5.066L7.746 57.758C4.04 53.367 6.062 46.612 11.45 44.923l26.604-8.444c1.684-.676 3.368-1.69 4.378-3.378L57.586 9.457c3.368-4.728 10.103-5.066 13.47-.337z"
            stroke="#A83727"
            strokeWidth={1.716}
            strokeMiterlimit={10}
          />
          <Path
            d="M71.057 7.769l16.5 22.63c1.011 1.351 2.695 2.702 4.379 3.04l26.941 7.43c5.388 1.352 7.745 8.107 4.378 12.498l-16.502 22.63c-1.01 1.351-1.684 3.378-1.684 5.067l1.347 28.034c.337 5.742-5.051 9.796-10.776 8.107l-26.604-8.782c-1.684-.676-3.704-.676-5.388 0L37.38 118.556c-4.714 2.702-10.44-1.351-10.44-7.093V83.428a8.313 8.313 0 00-1.683-5.066L7.746 56.407C4.04 52.016 6.062 45.26 11.45 43.572l26.604-8.444c1.684-.676 3.368-1.69 4.378-3.378L57.586 8.106c3.368-4.728 10.103-5.066 13.47-.337z"
            fill="url(#prefix__paint0_linear)"
          />
          <Path
            d="M47.483 66.878C59.27 60.122 79.14 51.34 109.111 47.625c3.367-.338 5.725 3.715 3.704 6.418-4.041 5.066-6.735 9.457-8.756 12.835-3.031 5.066-4.041 10.808-3.031 16.55 2.021 11.147 5.725 28.71.337 31.75-5.051 3.04-27.278-9.457-34.686-13.173-1.347-.675-2.694-.337-3.705.338-5.725 4.053-24.92 16.888-29.635 13.848-3.704-2.364-3.367-13.848-1.347-26.345 1.347-9.458 7.072-18.24 15.491-22.968z"
            fill="url(#prefix__paint1_linear)"
          />
          <Path
            opacity={0.5}
            d="M63.648 102.005c1.01 2.702-3.705 7.093-10.777 10.133-7.072 3.04-13.807 3.378-14.817.676-1.01-2.702 3.704-7.093 10.776-10.133 7.072-3.04 13.808-3.378 14.818-.676zM105.069 110.787c.674 2.027-.673 4.391-3.367 5.405-2.694 1.013-5.725.675-6.399-1.352-.673-2.026.674-4.391 3.368-5.404 2.694-1.351 5.725-.675 6.398 1.351z"
            fill="#FFFF52"
          />
          <Path
            opacity={0.6}
            d="M32.666 103.356l1.684-18.914c.336-3.716 0-6.418-2.02-9.12L14.817 53.367c-.674-.675-.674-1.689-.337-2.027 0-.337.337-1.35 1.347-1.688l26.604-8.444c3.03-1.014 4.715-3.04 6.398-5.743l11.787-21.279-13.47 20.604c-1.684 2.702-4.378 4.729-7.41 5.742l-26.603 8.444c-1.01.338-1.347 1.013-1.347 1.689 0 .338-.337 1.351.336 2.026l17.512 21.955c2.02 2.365 3.03 5.742 3.03 8.782v19.928z"
            fill="#fff"
          />
          <Path
            d="M46.473 39.856c1.01 3.04-5.388 7.431-13.807 10.133-8.42 2.703-16.165 2.703-17.175-.337-1.01-3.04 5.388-7.431 13.807-10.133 8.42-2.703 16.165-2.365 17.175.337z"
            fill="#fff"
          />
        </G>
        <Defs>
          <LinearGradient
            id="prefix__paint0_linear"
            x1={105.955}
            y1={121.144}
            x2={30.245}
            y2={18.402}
            gradientUnits="userSpaceOnUse"
          >
            <Stop stopColor="#FFB935" />
            <Stop offset={0.505} stopColor="#FFD639" />
            <Stop offset={0.941} stopColor="#FFF755" />
          </LinearGradient>
          <LinearGradient
            id="prefix__paint1_linear"
            x1={60.8}
            y1={48.664}
            x2={89.268}
            y2={130.939}
            gradientUnits="userSpaceOnUse"
          >
            <Stop stopColor="#FFDF3A" />
            <Stop offset={0.261} stopColor="#FFC736" />
            <Stop offset={0.504} stopColor="#FFB933" />
            <Stop offset={0.71} stopColor="#FFB432" />
          </LinearGradient>
        </Defs>
      </Svg>
    </Animated.View>
  );
}


